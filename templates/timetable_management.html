{% extends "base.html" %}

{% block title %}KUSIS - 시간표 관리{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/timetable.css') }}">
{% endblock %}

{% block content %}
<div class="content-area timetable-management-page">

    <div class="left-widgets">
        <div class="widget credit-widget">
            <div class="widget-header">
                <h3><i class="fas fa-graduation-cap"></i> 나의 학점</h3>
            </div>
            <div class="credit-summary">
                <div class="credit-progress-circle">
                    <svg viewBox="0 0 100 100">
                        <circle class="timer-bg" cx="50" cy="50" r="45"></circle>
                        <circle class="timer-progress" id="creditProgress" cx="50" cy="50" r="45"></circle>
                    </svg>
                    <div class="credit-text">
                        <span id="creditPercentage">0%</span>
                    </div>
                </div>
                <div class="credit-details">
                    <div class="stat-item">
                        <span class="stat-label">현재 학점</span>
                        <span class="stat-value" id="currentCredits">{{ current_credits }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">목표 학점</span>
                        <span class="stat-value" id="goalCredits">{{ goal_credits }}</span>
                    </div>
                </div>
                <div class="credit-remaining">
                    앞으로 <span id="remainingCredits">{{ goal_credits - current_credits }}</span>학점 남았습니다.
                </div>
            </div>
        </div>
        
        <div class="widget todo-summary-widget">
            <div class="widget-header">
                <h3><i class="fas fa-tasks"></i> 과목별 메모/Todo</h3>
            </div>
            <div class="todo-summary-list" id="todoSummaryList">
                <p style="text-align: center; color: var(--text-secondary); padding: 20px;">
                    시간표를 불러오는 중입니다...
                </p>
            </div>
        </div>
    </div>

    <div class="center-widgets">
        <div class="widget timetable-editor-widget">
            <div class="widget-header">
                <h3><i class="fas fa-edit"></i> 시간표 등록/수정</h3>
                <small>과목을 수정하려면 셀을 클릭하세요.</small>
            </div>
            <div class="timetable-container">
                <table class="timetable editable">
                    <thead>
                        <tr>
                            <th>시간</th>
                            <th>월</th>
                            <th>화</th>
                            <th>수</th>
                            <th>목</th>
                            <th>금</th>
                        </tr>
                    </thead>
                    <tbody id="timetableEditorBody">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

</div>

<div class="modal" id="subjectEditModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="subjectModalTitle">과목 추가</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <form id="subjectEditForm">
                <input type="hidden" id="subjectDay" name="day">
                <input type="hidden" id="subjectPeriod" name="period">
                
                <div class="input-group">
                    <label for="subjectName"><i class="fas fa-book"></i> 과목명</label>
                    <input type="text" id="subjectName" name="subject" required placeholder="예: 웹프로그래밍">
                </div>
                <div class="input-group">
                    <label for="subjectProfessor"><i class="fas fa-user-tie"></i> 교수명</label>
                    <input type="text" id="subjectProfessor" name="professor" placeholder="예: 이교수">
                </div>
                <div class="input-group">
                    <label for="subjectRoom"><i class="fas fa-map-marker-alt"></i> 강의실</label>
                    <input type="text" id="subjectRoom" name="room" placeholder="예: 창의관 205호">
                </div>
                <div class="input-group">
                    <label for="subjectCredits"><i class="fas fa-coins"></i> 학점</label>
                    <input type="number" id="subjectCredits" name="credits" value="3" min="0" max="9">
                    <small style="color: var(--text-secondary); font-size: 12px; margin-top: 5px;">
                        * 주 2회 수업의 경우, 한 곳에만 학점을 입력하세요.
                    </small>
                </div>
            </form>
        </div>
        <div class="modal-footer" style="justify-content: space-between;">
            <button class="btn btn-danger" id="deleteSubjectBtn" style="background: var(--color-danger);">
                <i class="fas fa-trash"></i> 삭제
            </button>
            <div>
                <button class="btn btn-cancel modal-close">취소</button>
                <button class="btn btn-save" id="saveSubjectBtn">저장</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block page_scripts %}
    <script src="{{ url_for('static', filename='js/timetable_management.js') }}"></script>
{% endblock %}