{% extends "base.html" %}

{% block title %}KUSIS - 홈{% endblock %}

{% block content %}

<div class="content-area">
    <div class="left-widgets">
        <div class="widget profile-widget">
            <div class="profile-header">
                <div class="profile-avatar">
                    <img src="{{ url_for('static', filename='images/default_avatar.png') }}" alt="프로필">
                </div>
                <div class="profile-info">
                    <h3 class="profile-name">장선규</h3>
                    <p class="profile-id">2023390822</p>
                    <p class="profile-dept">디지털경영전공</p>
                </div>
            </div>
            <div class="current-date">
                <i class="fas fa-calendar"></i>
                <span id="currentDate"></span>
            </div>
            <div class="study-timer">
                <h4 class="study-timer-title" style="text-align: center; margin-bottom: 15px; font-size: 16px; color: var(--text-primary);">공부 타이머</h4>
                <div class="timer-display">
                    <div class="timer-circle">
                        <svg viewBox="0 0 100 100">
                            <circle class="timer-bg" cx="50" cy="50" r="45"></circle>
                            <circle class="timer-progress" cx="50" cy="50" r="45" id="timerProgress"></circle>
                        </svg>
                        <div class="timer-text">
                            <span id="timerDisplay">00:00:00</span>
                        </div>
                    </div>
                </div>
                <div class="timer-controls">
                    <button class="btn-timer btn-start" id="startTimer">
                        <i class="fas fa-play"></i> 시작하기
                    </button>
                    <button class="btn-timer btn-stop" id="stopTimer" disabled>
                        <i class="fas fa-stop"></i> 그만하기
                    </button>
                </div>
                <div class="timer-stats">
                    <div class="stat-item">
                        <span class="stat-label">오늘</span>
                        <span class="stat-value" id="todayTime">0h 0m</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">이번주 평균</span>
                        <span class="stat-value" id="weeklyAvg">0h 0m</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="widget schedule-widget">
            <div class="widget-header">
                <h3><i class="fas fa-clock"></i> 오늘의 일정</h3>
                <button class="btn-more"><i class="fas fa-plus"></i></button>
            </div>
            <div class="schedule-list" id="scheduleList">
                </div>
        </div>
    </div>

    <div class="center-widgets">
        <div class="widget shuttle-widget">
            <div class="widget-header">
                <h3><i class="fas fa-bus"></i> 셔틀버스 시간표</h3>
                <div class="header-controls">
                    <button class="btn-more full-view-btn" data-target="shuttleModal">전체 시간표 확인</button>
                    <div id="currentTimeDisplay" class="current-time"></div>
                </div>
            </div>
            <div class="widget-tabs">
                <button class="tab active" data-tab="all">전체</button>
                <button class="tab" data-tab="school_to_station">학교→조치원역</button>
                <button class="tab" data-tab="station_to_school">조치원역→학교</button>
                <button class="tab" data-tab="osong">오송역 노선</button>
            </div>
            <div class="shuttle-list" id="shuttleList">
                </div>
        </div>

        <div class="widget meal-widget">
            <div class="widget-header">
                <div class="header-title-group"> 
                    <h3><i class="fas fa-utensils"></i> 오늘의 식단</h3>
                    <button class="full-view-btn" data-target="mealModal">이번주 전체 식단표 확인</button>
                </div>
                <div class="widget-tabs">
                    <button class="tab active" data-cafeteria="student">학생식당</button>
                    <button class="tab" data-cafeteria="faculty">교직원식당</button>
                </div>
            </div>
            <div class="meal-content">
                
                <div class="meal-item">
                    <h4><i class="fas fa-bread-slice"></i> 조식</h4>
                    <p id="breakfast">식단 정보 없음</p>
                </div>

                <div class="meal-item" id="studentLunchContainer">
                    <h4><i class="fas fa-sun"></i> 중식</h4>
                    <div class="meal-menu-group" id="studentLunchSection">
                        <div class="meal-category">
                            <div class="category-title">한식</div>
                            <p id="lunch-korean" class="meal-content-text">식단 정보 없음</p>
                        </div>
                        <div class="meal-category">
                            <div class="category-title">일품/분식</div>
                            <p id="lunch-ala_carte" class="meal-content-text">식단 정보 없음</p>
                        </div>
                        <div class="meal-category">
                            <div class="category-title">Plus</div>
                            <p id="lunch-snack_plus" class="meal-content-text">식단 정보 없음</p>
                        </div>
                    </div>
                </div>

                <div class="meal-item" id="facultyLunchContainer" style="display: none;">
                    <h4><i class="fas fa-sun"></i> 중식</h4>
                    <p id="lunch-faculty">식단 정보 없음</p>
                </div>

                <div class="meal-item">
                    <h4><i class="fas fa-moon"></i> 석식</h4>
                    <p id="dinner">식단 정보 없음</p>
                </div>
            </div>
        </div>
    </div>

    <div class="right-widgets">
        <div class="widget timetable-widget">
            <div class="widget-header">
                <h3><i class="fas fa-table"></i> 이번주 시간표</h3>
                <button class="btn-more"><i class="fas fa-edit"></i></button>
            </div>
            <div class="timetable-container">
                <table class="timetable">
                    <thead>
                        <tr>
                            <th>시간</th>
                            <th>월</th>
                            <th>화</th>
                            <th>수</th>
                            <th>목</th>
                            <th>금</th>
                        </tr>
                    </thead>
                    <tbody id="timetableBody">
                        </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="memoModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>수업 메모</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <textarea id="memoText" rows="5" placeholder="메모를 입력하세요..."></textarea>
        </div>
        <div class="modal-footer">
            <button class="btn btn-cancel modal-close">취소</button>
            <button class="btn btn-save">저장</button>
        </div>
    </div>
</div>

<div class="modal large-modal" id="shuttleModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>셔틀버스 전체 시간표</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="shuttle-full-table-container">
                </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-cancel modal-close">닫기</button>
        </div>
    </div>
</div>

<div class="modal large-modal" id="mealModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>이번주 전체 식단표</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="meal-full-table-container">
                </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-cancel modal-close">닫기</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}